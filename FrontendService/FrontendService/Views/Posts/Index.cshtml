@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@model List<PostDTO>

<div class="container">
    @foreach (var post in Model)
    {
        <div class="card my-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h2>@post.Title</h2>
                <span class="text-muted small">Author: @post.AuthorName</span>
            </div>
            <div class="card-body">
                <p>@post.Description</p>
            </div>
            <div class="card-footer text-muted">
                <div class="d-flex justify-content-between">
                    <span>Published: @post.PublishDate.ToString("dddd, MMMM dd, yyyy")</span> -
                    <span>@GetTimeAgo(post.PublishDate)</span>
                </div>
            </div>
        </div>
    }
</div>

@functions {
    public string GetTimeAgo(DateTime publishDate)
    {
        var timeSpan = DateTime.Now - publishDate;

        if (timeSpan.TotalMinutes < 1)
            return "Just now";
        if (timeSpan.TotalMinutes < 60)
            return $"{timeSpan.Minutes} min ago";
        if (timeSpan.TotalHours < 24)
            return $"{timeSpan.Hours} hr ago";
        if (timeSpan.TotalDays < 7)
            return $"{timeSpan.Days} days ago";

        return publishDate.ToString("MMMM dd, yyyy");
    }
}

